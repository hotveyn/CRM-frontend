import{d as g,m as p,f as y,g as v,a as m,N as k,o as l,t as S,v as x,x as N,n as w,i as D,p as f,k as F,w as T,c as h,b as q}from"./index-611e9b0c.js";import{a as B}from"./Select-a37c4bef.js";import{N as C,a as O}from"./Skeleton-69fe88cc.js";import{a as U}from"./departments.store-ddc191d6.js";import{N as z}from"./Divider-15a26f45.js";import"./use-locale-88ac332a.js";import"./cssr-4e584e7e.js";import"./Suffix-6415451c.js";import"./get-2fdf10cf.js";import"./Empty-c66f08c7.js";import"./get-slot-1efb97e5.js";import"./ChevronRight-e0dd4c69.js";import"./Forward-5e805774.js";import"./Input-c7379108.js";const A={class:"table-fired"},E=g({__name:"TableFired",props:{tableData:{},filters:{}},emits:["unfire"],setup(s,{emit:r}){const o=s,n=u({unfire:a=>{r("unfire",a)}});function u(a){return[{title:"Номер",key:"code",sorter:"default"},{title:"ФИО",key:"name",sorter:"default"},{title:"Отделы",key:"departments",render(t){return t.departments.map(i=>p(B,{style:{marginRight:"6px"},type:"info",bordered:!1},{default:()=>i}))},filterOptions:o.filters,filter(t,i){return i.departments.indexOf(t)!==-1}},{title:"Действия",key:"actions",render(t){return p(k,{type:"warning",size:"small",style:{marginRight:"6px"},onClick:()=>a.unfire(t.id)},{default:()=>"Нанять обратно"})}}]}return(a,t)=>(l(),y("div",A,[v(m(C),{"single-line":!1,data:a.tableData,columns:m(n),pagination:{pageSize:30},bordered:!0},null,8,["data","columns"])]))}}),d=N(),_=S(),R=x("fired-employees",{state:()=>({users:[],touched:!1}),actions:{async getOrRequest(){return this.touched||(this.users=await d.getAllFired(),this.touched=!0),this.users},async request(){this.users=await d.getAllFired(),this.touched=!0},async unfire(s){d.unfire(s).then(()=>{_.user.unfire()}).catch(r=>{_.error.custom(r.response.data.message)}),this.users=this.users.filter(r=>r.id!==s)}}}),M={class:"admin-users-fired"},I=g({__name:"PageAdminEmployeesFired",setup(s){const{confirm:r}=w(),o=U(),n=R(),u=D(!0),a=f(()=>n.users.map(e=>{const c=[];return e.departments&&e.departments.forEach(b=>{c.push(b.name)}),{id:e.id,name:[e.last_name,e.first_name,e.patronymic_name].join(" "),code:e.code,departments:c}})),t=f(()=>o.departments.map(e=>({label:e.name,value:e.name})));function i(e){r(async()=>{await n.unfire(e)})}return F(async()=>{await n.request(),await o.request(),u.value=!1}),(e,c)=>(l(),y("div",M,[v(m(z),{"title-placement":"left"},{default:T(()=>[q("Уволенные сотрудники")]),_:1}),u.value?(l(),h(m(O),{key:0,width:"100%",height:"52px",sharp:!1,text:"",size:"medium",repeat:5})):(l(),h(E,{key:1,"table-data":a.value,onUnfire:i,filters:t.value},null,8,["table-data","filters"]))]))}});export{I as default};

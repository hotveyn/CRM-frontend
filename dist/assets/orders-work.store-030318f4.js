import{t as a,v as c,bI as p}from"./index-62384645.js";import{u as m}from"./order.service-15093fdc.js";import{a as y}from"./departments.store-3fc2218e.js";import{u as f}from"./orderTypes.store-cd2a7c53.js";const d=m(),o=a(),g=c("orders-work",{state:()=>({orders:[]}),actions:{async request(){this.orders=await d.getWork()},findById(r){return this.orders.find(e=>e.id===r)},async deleteOne(r){d.hide(r).then(()=>{o.order.removed();const e=this.findById(r);if(e){const t=this.orders.indexOf(e);this.orders.splice(t,1)}})},async update(r,e){d.update(r,e).then(async()=>{o.order.updated();const t=y(),s=this.findById(r);if(s){if(e.name&&(s.name=e.name),s.comment=e.comment,e.type_id){const i=await f().findById(e.type_id);i&&(s.type=i)}if(e.departments&&e.departments.length){const n=t.findById(e.departments[0].department_id);n&&(s.current_department=n.name)}}}).catch(t=>{t instanceof p&&o.error.custom(t.response.data.message)})}}});export{g as u};

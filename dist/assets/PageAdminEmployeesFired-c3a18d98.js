import{d as g,m as p,f as y,g as x,a as m,N as b,o as l,t as k,v as w,x as S,n as N,i as D,p as f,k as F,w as T,c as h,b as q}from"./index-62384645.js";import{a as B}from"./Select-8ae686c1.js";import{N as C,a as O}from"./Skeleton-a17865c3.js";import{a as U}from"./departments.store-3fc2218e.js";import{N as z}from"./Divider-bdda2be5.js";import"./use-locale-a4cb9846.js";import"./cssr-1cbf0123.js";import"./Suffix-86caeb40.js";import"./get-806e042e.js";import"./Empty-6144791c.js";import"./get-slot-1efb97e5.js";import"./ChevronRight-7e3f7794.js";import"./Forward-d200b360.js";import"./Input-c95d618b.js";const A={class:"table-fired"},E=g({__name:"TableFired",props:{tableData:{},filters:{}},emits:["unfire"],setup(s,{emit:r}){const o=s,i=u({unfire:a=>{r("unfire",a)}});function u(a){return[{title:"Номер",key:"code",sorter:"default"},{title:"ФИО",key:"name",sorter:"default"},{title:"Отделы",key:"departments",render(t){return t.departments.map(n=>p(B,{style:{marginRight:"6px",width:"100%",maxWidth:"100px"},type:"info",bordered:!1},{default:()=>n}))},filterOptions:o.filters,filter(t,n){return n.departments.indexOf(t)!==-1}},{title:"Действия",key:"actions",render(t){return p(b,{type:"warning",size:"small",style:{marginRight:"6px",width:"100%",maxWidth:"100px"},onClick:()=>a.unfire(t.id)},{default:()=>"Нанять обратно"})}}]}return(a,t)=>(l(),y("div",A,[x(m(C),{"single-line":!1,data:a.tableData,columns:m(i),pagination:{pageSize:30},bordered:!0},null,8,["data","columns"])]))}}),c=S(),_=k(),R=w("fired-employees",{state:()=>({users:[],touched:!1}),actions:{async getOrRequest(){return this.touched||(this.users=await c.getAllFired(),this.touched=!0),this.users},async request(){this.users=await c.getAllFired(),this.touched=!0},async unfire(s){c.unfire(s).then(()=>{_.user.unfire()}).catch(r=>{_.error.custom(r.response.data.message)}),this.users=this.users.filter(r=>r.id!==s)}}}),M={class:"admin-users-fired"},I=g({__name:"PageAdminEmployeesFired",setup(s){const{confirm:r}=N(),o=U(),i=R(),u=D(!0),a=f(()=>i.users.map(e=>{const d=[];return e.departments&&e.departments.forEach(v=>{d.push(v.name)}),{id:e.id,name:[e.last_name,e.first_name,e.patronymic_name].join(" "),code:e.code,departments:d}})),t=f(()=>o.departments.map(e=>({label:e.name,value:e.name})));function n(e){r(async()=>{await i.unfire(e)})}return F(async()=>{await i.request(),await o.request(),u.value=!1}),(e,d)=>(l(),y("div",M,[x(m(z),{"title-placement":"left"},{default:T(()=>[q("Уволенные сотрудники")]),_:1}),u.value?(l(),h(m(O),{key:0,width:"100%",height:"52px",sharp:!1,text:"",size:"medium",repeat:5})):(l(),h(E,{key:1,"table-data":a.value,onUnfire:n,filters:t.value},null,8,["table-data","filters"]))]))}});export{I as default};

import{i as _,k as C,j as S,d as b,o as N,c as M,w as l,g as a,a as e,bM as k,av as x,be as T,b as g,l as O,N as F,f as q,_ as I}from"./index-611e9b0c.js";import{u as D}from"./orderTypes.store-de919220.js";import{u as P}from"./orders-new.store-f37d5b42.js";import{N as R}from"./Switch-b3f379bb.js";import{N as c}from"./Input-c7379108.js";import{N as u,a as U}from"./FormItem-856fbc7c.js";import{N as B}from"./InputNumber-0fec01df.js";import{N as y}from"./DatePicker-c578e912.js";import{N as V}from"./Select-a37c4bef.js";import{u as h}from"./prefab.store-ed3cb698.js";import{N as w,a as $}from"./Tabs-39f841c3.js";import{N as z}from"./Divider-15a26f45.js";import"./order.service-397beea0.js";import"./use-locale-88ac332a.js";import"./Suffix-6415451c.js";import"./get-2fdf10cf.js";import"./Add-c3af3fde.js";import"./Forward-5e805774.js";import"./cssr-4e584e7e.js";import"./Empty-c66f08c7.js";function j(){const p={name:{required:!0,message:"Введите название заказа"},date_start:{required:!0,message:"Введите дату начала"},date_end:{required:!0,message:"Введите дату сдачи"},price:{required:!0,message:"Введите длину неона"},type_id:{required:!0,message:"Выберите тип вывески"}},s=_(!1),n=_([]);C(async()=>{const i=D();n.value=await i.getForSelect(),n.value[0]&&(t.type_id=n.value[0].value)});const t=S({name:"",date_start:new Date().toISOString().split("T")[0],date_end:new Date().toISOString().split("T")[0],price:1,type_id:void 0,comment:"",reclamation_number:""});return{rules:p,isReclamation:s,options:n,formValues:t}}const E=b({__name:"FormOrderCreate",setup(p){const s=P(),{rules:n,formValues:t,options:i,isReclamation:m}=j(),v=_();function f(){var d;(d=v.value)==null||d.validate(async r=>{r||await s.create(t)})}return(d,r)=>(N(),M(e(U),{ref_key:"orderCreateFormRef",ref:v,rules:e(n),model:e(t)},{default:l(()=>[a(e(u),{label:"Название заказа",path:"name"},{default:l(()=>[a(e(c),{value:e(t).name,"onUpdate:value":r[0]||(r[0]=o=>e(t).name=o),placeholder:""},null,8,["value"])]),_:1}),a(e(u),{label:"Стоимость вывески",path:"price"},{default:l(()=>[a(e(B),{min:0,value:e(t).price,"onUpdate:value":r[1]||(r[1]=o=>e(t).price=o),placeholder:"",precision:2},null,8,["value"])]),_:1}),a(e(u),{label:"Дата начала",path:"date_start"},{default:l(()=>[a(e(y),{"value-format":"yyyy-MM-dd","formatted-value":e(t).date_start,"onUpdate:formattedValue":r[2]||(r[2]=o=>e(t).date_start=o),style:{width:"100%"},placeholder:"",type:"date"},null,8,["formatted-value"])]),_:1}),a(e(u),{label:"Дата сдачи",path:"date_end"},{default:l(()=>[a(e(y),{"value-format":"yyyy-MM-dd","formatted-value":e(t).date_end,"onUpdate:formattedValue":r[3]||(r[3]=o=>e(t).date_end=o),style:{width:"100%"},placeholder:"",type:"date"},null,8,["formatted-value"])]),_:1}),a(e(u),{label:"Тип вывески",path:"type_id"},{default:l(()=>[a(e(V),{value:e(t).type_id,"onUpdate:value":r[4]||(r[4]=o=>e(t).type_id=o),remote:"",options:e(i)},null,8,["value","options"])]),_:1}),a(e(u),{label:"Ваш комментарий к заказу"},{default:l(()=>[a(e(c),{value:e(t).comment,"onUpdate:value":r[5]||(r[5]=o=>e(t).comment=o),type:"textarea",placeholder:""},null,8,["value"])]),_:1}),a(e(u),{label:"Гарантийный заказ?"},{default:l(()=>[a(e(R),{value:e(m),"onUpdate:value":r[6]||(r[6]=o=>k(m)?m.value=o:null)},null,8,["value"])]),_:1}),x(a(e(u),{label:"Номер гарантийного талона",path:"departments"},{default:l(()=>[a(e(c),{value:e(t).reclamation_number,"onUpdate:value":r[7]||(r[7]=o=>e(t).reclamation_number=o),placeholder:""},null,8,["value"])]),_:1},512),[[T,e(m)]]),a(e(F),{type:"primary",onClick:r[8]||(r[8]=O(o=>f(),["prevent"]))},{default:l(()=>[g(" Создать ")]),_:1})]),_:1},8,["rules","model"]))}});function A(){const p={date_start:{required:!0,message:"Введите дату начала"},prefab_id:{required:!0,message:"Выберите шаблон"}},s=_([]),n=S({date_start:new Date().toISOString().split("T")[0],date_end:new Date().toISOString().split("T")[0],prefab_id:void 0});return C(async()=>{const t=h();await t.request(),s.value=t.prefabs.map(i=>({label:i.name,value:i.id})),s.value[0]&&(n.prefab_id=s.value[0].value)}),{rules:p,options:s,formValues:n}}const G=b({__name:"FormOrderPrefabCreate",setup(p){const s=P(),{rules:n,formValues:t,options:i}=A(),m=_();function v(){var f;(f=m.value)==null||f.validate(async d=>{d||await s.createByPrefab(t)})}return(f,d)=>(N(),M(e(U),{ref_key:"orderPrefabCreateFormRef",ref:m,rules:e(n),model:e(t)},{default:l(()=>[a(e(u),{label:"Шаблон",path:"prefab_id"},{default:l(()=>[a(e(V),{value:e(t).prefab_id,"onUpdate:value":d[0]||(d[0]=r=>e(t).prefab_id=r),remote:"",options:e(i)},null,8,["value","options"])]),_:1}),a(e(u),{label:"Дата начала",path:"date_start"},{default:l(()=>[a(e(y),{"value-format":"yyyy-MM-dd","formatted-value":e(t).date_start,"onUpdate:formattedValue":d[1]||(d[1]=r=>e(t).date_start=r),style:{width:"100%"},placeholder:"",type:"date"},null,8,["formatted-value"])]),_:1}),a(e(u),{label:"Дата сдачи",path:"date_end"},{default:l(()=>[a(e(y),{"value-format":"yyyy-MM-dd","formatted-value":e(t).date_end,"onUpdate:formattedValue":d[2]||(d[2]=r=>e(t).date_end=r),style:{width:"100%"},placeholder:"",type:"date"},null,8,["formatted-value"])]),_:1}),a(e(F),{type:"primary",onClick:d[3]||(d[3]=O(r=>v(),["prevent"]))},{default:l(()=>[g(" Создать")]),_:1})]),_:1},8,["rules","model"]))}}),H={class:"manager-orders-create"},J=b({__name:"PageManagerOrdersCreate",setup(p){return(s,n)=>(N(),q("div",H,[a(e(z),{"title-placement":"center"},{default:l(()=>[g(" Добавить заказ")]),_:1}),a(e($),{type:"card",animated:""},{default:l(()=>[a(e(w),{placement:"left",size:"small",name:"new",tab:"Новый"},{default:l(()=>[a(E)]),_:1}),a(e(w),{placement:"left",size:"small",name:"prefab",tab:"Из шаблона"},{default:l(()=>[a(G)]),_:1})]),_:1})]))}});const fe=I(J,[["__scopeId","data-v-93101d52"]]);export{fe as default};
